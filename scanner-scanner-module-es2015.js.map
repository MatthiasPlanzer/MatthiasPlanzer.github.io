{"version":3,"sources":["./src/app/add-product/add-product.component.html","./src/app/scanner/scanner.page.html","./src/app/add-product/add-product.component.scss","./src/app/add-product/add-product.component.ts","./src/app/scanner/scanner-routing.module.ts","./src/app/scanner/scanner.module.ts","./src/app/scanner/scanner.page.scss","./src/app/scanner/scanner.page.ts"],"names":[],"mappings":"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","file":"scanner-scanner-module-es2015.js","sourcesContent":["export default \"<div *ngIf=\\\"product\\\">\\n  <link rel=\\\"stylesheet\\\" href=\\\"https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css\\\" integrity=\\\"sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2\\\" crossorigin=\\\"anonymous\\\">\\n  <ion-header translucent>\\n    <ion-toolbar>\\n      <ion-title>{{ product.product_name }}</ion-title>\\n      <ion-buttons slot=\\\"end\\\">\\n        <ion-button (click)=\\\"dismissModal()\\\">Schliessen</ion-button>\\n      </ion-buttons>\\n    </ion-toolbar>\\n  </ion-header>\\n  <ion-content fullscreen>\\n    <img [src]=\\\"product.image_url\\\">\\n    <button (click)=\\\"confirmAdding()\\\">Produkt hinzufügen</button>\\n    <table class=\\\"table\\\">\\n      <thead>\\n        <tr>\\n          <th>Menge</th>\\n          <th>Nährwert</th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n        <tr>\\n          <td>Kohlenhydrate</td>\\n          <td>{{ product.nutriments.carbohydrates }}</td>\\n        </tr>\\n        <tr>\\n          <td>davon Zucker</td>\\n          <td>{{ product.nutriments.fat }}</td>\\n        </tr>\\n        <tr>\\n          <td>Energie</td>\\n          <td>{{ product.nutriments.energy }}kJ / {{ product.nutriments.energy-kcal }}kJ</td>\\n        </tr>\\n        <tr>\\n          <td>Fett</td>\\n          <td>{{ product.nutriments.fat }}</td>\\n        </tr>\\n      </tbody>\\n    </table>\\n  </ion-content>\\n</div>\";","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>Barcode-Scanner</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content *ngIf=\\\"enabled\\\">\\n  <zxing-scanner [(device)]=\\\"currentDevice\\\" (scanSuccess)=\\\"onCodeResult($event)\\\"\\n  [formats]=\\\"formatsEnabled\\\"  [enable]=\\\"enabled\\\" (permissionResponse)=\\\"onHasPermission($event)\\\"\\n  (camerasFound)=\\\"onCamerasFound($event)\\\"></zxing-scanner>\\n</ion-content>\\n\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2FkZC1wcm9kdWN0L2FkZC1wcm9kdWN0LmNvbXBvbmVudC5zY3NzIn0= */\";","import { Component, Input, OnInit } from '@angular/core';\nimport { AlertController } from '@ionic/angular';\nimport { ModalController } from '@ionic/angular';\nimport { ProductsService } from '../products.service';\n\n@Component({\n  selector: 'app-add-product',\n  templateUrl: './add-product.component.html',\n  styleUrls: ['./add-product.component.scss'],\n})\nexport class AddProductComponent implements OnInit {\n  @Input() code: string;\n  public product: any;\n  constructor(public modalController: ModalController, public productsService: ProductsService) { }\n\n  async ngOnInit() {\n    console.log(this.code);\n    var product = await this.productsService.getProductDetails(this.code);\n    this.product = product;\n    console.log(product);\n  }\n  \n  async confirmAdding() {\n    var status = await this.productsService.addProduct(this.product); \n    this.modalController.dismiss();\n  }\n\n  dismissModal() {\n    if (this.modalController) {\n      this.modalController.dismiss({\n      });\n    }\n  }\n\n}\n","import { NgModule } from \"@angular/core\";\nimport { Routes, RouterModule } from \"@angular/router\";\n\nimport { ScannerPage } from \"./scanner.page\";\n\nconst routes: Routes = [\n  {\n    path: \"\",\n    component: ScannerPage,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ScannerPageRoutingModule {}\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { FormsModule } from \"@angular/forms\";\n\nimport { IonicModule } from \"@ionic/angular\";\n\nimport { ScannerPageRoutingModule } from \"./scanner-routing.module\";\n\nimport { ScannerPage } from \"./scanner.page\";\nimport { ZXingScannerModule } from \"@zxing/ngx-scanner\";\nimport { AddProductComponent } from '../add-product/add-product.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ScannerPageRoutingModule,\n    ZXingScannerModule,\n  ],\n  exports: [\n    ScannerPage,\n    AddProductComponent\n  ],\n  declarations: [ScannerPage, AddProductComponent],\n})\nexport class ScannerPageModule { }\n","export default \"zxing-scanner {\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvc2Nhbm5lci9zY2FubmVyLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFlBQUE7QUFDSiIsImZpbGUiOiJzcmMvYXBwL3NjYW5uZXIvc2Nhbm5lci5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJ6eGluZy1zY2FubmVyIHtcbiAgICBoZWlnaHQ6IDEwMCU7XG59Il19 */\";","import { Component, Input, OnInit } from '@angular/core';\nimport { AlertController, ModalController } from '@ionic/angular';\nimport { BarcodeFormat } from '@zxing/library';\nimport { BehaviorSubject } from 'rxjs';\nimport { AddProductComponent } from '../add-product/add-product.component';\nimport { ProductsService } from '../products.service';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: 'scanner.page.html',\n  styleUrls: ['./scanner.page.scss']\n})\nexport class ScannerPage{\n  @Input() modalOpen = false;\n\n  availableDevices: MediaDeviceInfo[];\n  currentDevice: MediaDeviceInfo = null;\n\n  formatsEnabled: BarcodeFormat[] = [\n    BarcodeFormat.CODE_128,\n    BarcodeFormat.DATA_MATRIX,\n    BarcodeFormat.EAN_13,\n    BarcodeFormat.QR_CODE,\n  ];\n  hasDevices: boolean;\n  hasPermission: boolean;\n\n  qrResultString: string;\n\n  enabled = true;\n\n  modal: HTMLIonModalElement = null;\n\n\n  constructor(\n    public modalController: ModalController,\n    public productsService: ProductsService,\n    public alertController: AlertController) {\n  }\n  ionViewWillEnter() {\n    console.log('enter')\n    this.enabled = true;\n  }\n  ionViewWillLeave() {\n    console.log('leave')\n    this.enabled = false;\n  }\n  async generateModal() {\n    this.modal = await this.modalController.create({\n      component: AddProductComponent,\n      componentProps: {\n        code: this.qrResultString\n      }\n    });\n    await this.modal.present();\n    let { data } = await this.modal.onWillDismiss();\n    this.modalOpen = false;\n  }\n\n  clearResult(): void {\n    this.qrResultString = null;\n  }\n\n  onCamerasFound(devices: MediaDeviceInfo[]): void {\n    this.availableDevices = devices;\n    this.hasDevices = Boolean(devices && devices.length);\n  }\n\n  onCodeResult(resultString: string) {\n    this.qrResultString = resultString;\n    var errorDialog = this.errorDialog.bind(this);\n    var generateModal = this.generateModal.bind(this);\n    if (this.modalOpen === false) {\n      this.modalOpen = true;\n      this.productsService.getProductDetails(resultString).then(function () {\n        generateModal();\n      }).catch(function (error) {\n        console.log(error);\n        errorDialog();\n      })\n    }\n  }\n\n  async errorDialog() {\n    const alert = await this.alertController.create({\n      header: 'Fehler',\n      message: 'Das gescannte Produkt ist nicht in unserer Datenbank erfasst. Möchten Sie dies dem Entwickler melden?',\n      buttons: [\n        {\n          text: 'Nein',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: () => {\n            this.modalOpen = false;\n          }\n        }, {\n          text: 'Ja',\n          handler: () => {\n            window.location.href = \"mailto:nutriinfo.app@gmail.com?subject=Fehlerbericht%20NutriInfo&body=Ein%20Fehler%20mit%20dem%20Barcode%20Scanner%20wurde%20erkannt.%20Der%20Barcode%20\\\"[]\\\"%20konnte%20nicht%20in%20unserer%20Datenbank%20gefunden%20werden.%0D%0ABitte%20geben%20Sie%20manuell%20den%20Namen%20des%20Produktes%20an:\".replace(\"[]\", this.qrResultString);\n            this.modalOpen = false;\n          }\n        }\n      ]\n    });\n\n    await alert.present().then(function () {\n    }.bind(this))\n  }\n\n  onDeviceSelectChange(selected: string) {\n    const device = this.availableDevices.find(x => x.deviceId === selected);\n    this.currentDevice = device || null;\n    console.log(\"new device\", device)\n  }\n\n  onHasPermission(has: boolean) {\n    this.hasPermission = has;\n  }\n\n  openInfoDialog() {\n    const data = {\n      hasDevices: this.hasDevices,\n      hasPermission: this.hasPermission,\n    };\n\n    // this._dialog.open(AppInfoDialogComponent, { data });\n  }\n}\n"],"sourceRoot":"webpack:///"}