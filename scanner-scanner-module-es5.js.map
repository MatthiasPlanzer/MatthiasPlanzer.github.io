{"version":3,"sources":["webpack:///src/app/add-product/add-product.component.html","webpack:///src/app/scanner/scanner.page.html","webpack:///src/app/add-product/add-product.component.scss","webpack:///src/app/add-product/add-product.component.ts","webpack:///src/app/scanner/scanner-routing.module.ts","webpack:///src/app/scanner/scanner.module.ts","webpack:///src/app/scanner/scanner.page.scss","webpack:///src/app/scanner/scanner.page.ts"],"names":["AddProductComponent","modalController","productsService","console","log","code","getProductDetails","product","addProduct","status","dismiss","selector","template","routes","path","component","ScannerPageRoutingModule","imports","forChild","exports","ScannerPageModule","declarations","ScannerPage","alertController","modalOpen","currentDevice","formatsEnabled","CODE_128","DATA_MATRIX","EAN_13","QR_CODE","enabled","modal","create","componentProps","qrResultString","present","onWillDismiss","data","devices","availableDevices","hasDevices","Boolean","length","resultString","errorDialog","bind","generateModal","then","error","header","message","buttons","text","role","cssClass","handler","window","location","href","replace","alert","selected","device","find","x","deviceId","has","hasPermission"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAe;;;AAAA;;;;;;;;;;;;;;;;ACAf;AAAe;;;AAAA;;;;;;;;;;;;;;;;ACAf;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCWFA,mBAAmB;AAG9B,qCAAmBC,eAAnB,EAA4DC,eAA5D,EAA8F;AAAA;;AAA3E,eAAAD,eAAA,GAAAA,eAAA;AAAyC,eAAAC,eAAA,GAAAA,eAAA;AAAqC;;AAHnE;AAAA;AAAA,qCAKb;;;;;;;AACfC,6BAAO,CAACC,GAAR,CAAY,KAAKC,IAAjB;;AACc,6BAAM,KAAKH,eAAL,CAAqBI,iBAArB,CAAuC,KAAKD,IAA5C,CAAN;;;AAAVE,6B;AACJ,2BAAKA,OAAL,GAAeA,OAAf;AACAJ,6BAAO,CAACC,GAAR,CAAYG,OAAZ;;;;;;;;;AACD;AAV6B;AAAA;AAAA,0CAYR;;;;;;;;AACP,6BAAM,KAAKL,eAAL,CAAqBM,UAArB,CAAgC,KAAKD,OAArC,CAAN;;;AAATE,4B;AACJ,2BAAKR,eAAL,CAAqBS,OAArB;;;;;;;;;AACD;AAf6B;AAAA;AAAA,yCAiBf;AACb,gBAAI,KAAKT,eAAT,EAA0B;AACxB,mBAAKA,eAAL,CAAqBS,OAArB,CAA6B,EAA7B;AAED;AACF;AAtB6B;;AAAA;AAAA,S;;;;gBATvB;;gBAEA;;;;;;gBAQN;;;AADUV,yBAAmB,6DAL/B,gEAAU;AACTW,gBAAQ,EAAE,iBADD;AAETC,gBAAQ,EAAR;AAAA;AAAA,6GAFS;;;;AAAA,OAAV,CAK+B,GAAnBZ,mBAAmB,CAAnB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNb,UAAMa,MAAM,GAAW,CACrB;AACEC,YAAI,EAAE,EADR;AAEEC,iBAAS,EAAE;AAFb,OADqB,CAAvB;;UAWaC,wBAAwB;AAAA;AAAA,O;;AAAxBA,8BAAwB,6DAJpC,+DAAS;AACRC,eAAO,EAAE,CAAC,6DAAaC,QAAb,CAAsBL,MAAtB,CAAD,CADD;AAERM,eAAO,EAAE,CAAC,4DAAD;AAFD,OAAT,CAIoC,GAAxBH,wBAAwB,CAAxB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCUAI,iBAAiB;AAAA;AAAA,O;;AAAjBA,uBAAiB,6DAd7B,+DAAS;AACRH,eAAO,EAAE,CACP,4DADO,EAEP,0DAFO,EAGP,0DAHO,EAIP,gFAJO,EAKP,qEALO,CADD;AAQRE,eAAO,EAAE,CACP,yDADO,EAEP,sFAFO,CARD;AAYRE,oBAAY,EAAE,CAAC,yDAAD,EAAc,sFAAd;AAZN,OAAT,CAc6B,GAAjBD,iBAAiB,CAAjB;;;;;;;;;;;;;;;;AC1Bb;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCYFE,WAAW;AAsBtB,6BACSrB,eADT,EAESC,eAFT,EAGSqB,eAHT,EAG2C;AAAA;;AAFlC,eAAAtB,eAAA,GAAAA,eAAA;AACA,eAAAC,eAAA,GAAAA,eAAA;AACA,eAAAqB,eAAA,GAAAA,eAAA;AAxBA,eAAAC,SAAA,GAAY,KAAZ;AAGT,eAAAC,aAAA,GAAiC,IAAjC;AAEA,eAAAC,cAAA,GAAkC,CAChC,6DAAcC,QADkB,EAEhC,6DAAcC,WAFkB,EAGhC,6DAAcC,MAHkB,EAIhC,6DAAcC,OAJkB,CAAlC;AAWA,eAAAC,OAAA,GAAU,IAAV;AAEA,eAAAC,KAAA,GAA6B,IAA7B;AAOC;;AA1BqB;AAAA;AAAA,6CA2BH;AACjB7B,mBAAO,CAACC,GAAR,CAAY,OAAZ;AACA,iBAAK2B,OAAL,GAAe,IAAf;AACD;AA9BqB;AAAA;AAAA,6CA+BH;AACjB5B,mBAAO,CAACC,GAAR,CAAY,OAAZ;AACA,iBAAK2B,OAAL,GAAe,KAAf;AACD;AAlCqB;AAAA;AAAA,0CAmCA;;;;;;;;;AACP,6BAAM,KAAK9B,eAAL,CAAqBgC,MAArB,CAA4B;AAC7ClB,iCAAS,EAAE,sFADkC;AAE7CmB,sCAAc,EAAE;AACd7B,8BAAI,EAAE,KAAK8B;AADG;AAF6B,uBAA5B,CAAN;;;AAAb,2BAAKH,K;;AAML,6BAAM,KAAKA,KAAL,CAAWI,OAAX,EAAN;;;;AACe,6BAAM,KAAKJ,KAAL,CAAWK,aAAX,EAAN;;;;AAATC,0B,yBAAAA,I;AACN,2BAAKd,SAAL,GAAiB,KAAjB;;;;;;;;;AACD;AA7CqB;AAAA;AAAA,wCA+CX;AACT,iBAAKW,cAAL,GAAsB,IAAtB;AACD;AAjDqB;AAAA;AAAA,yCAmDPI,OAnDO,EAmDmB;AACvC,iBAAKC,gBAAL,GAAwBD,OAAxB;AACA,iBAAKE,UAAL,GAAkBC,OAAO,CAACH,OAAO,IAAIA,OAAO,CAACI,MAApB,CAAzB;AACD;AAtDqB;AAAA;AAAA,uCAwDTC,YAxDS,EAwDa;AACjC,iBAAKT,cAAL,GAAsBS,YAAtB;AACA,gBAAIC,WAAW,GAAG,KAAKA,WAAL,CAAiBC,IAAjB,CAAsB,IAAtB,CAAlB;AACA,gBAAIC,aAAa,GAAG,KAAKA,aAAL,CAAmBD,IAAnB,CAAwB,IAAxB,CAApB;;AACA,gBAAI,KAAKtB,SAAL,KAAmB,KAAvB,EAA8B;AAC5B,mBAAKA,SAAL,GAAiB,IAAjB;AACA,mBAAKtB,eAAL,CAAqBI,iBAArB,CAAuCsC,YAAvC,EAAqDI,IAArD,CAA0D,YAAY;AACpED,6BAAa;AACd,eAFD,WAES,UAAUE,KAAV,EAAiB;AACxB9C,uBAAO,CAACC,GAAR,CAAY6C,KAAZ;AACAJ,2BAAW;AACZ,eALD;AAMD;AACF;AArEqB;AAAA;AAAA,wCAuEF;;;;;;;;;;AACJ,6BAAM,KAAKtB,eAAL,CAAqBU,MAArB,CAA4B;AAC9CiB,8BAAM,EAAE,QADsC;AAE9CC,+BAAO,EAAE,uGAFqC;AAG9CC,+BAAO,EAAE,CACP;AACEC,8BAAI,EAAE,MADR;AAEEC,8BAAI,EAAE,QAFR;AAGEC,kCAAQ,EAAE,WAHZ;AAIEC,iCAAO,EAAE,mBAAM;AACb,iCAAI,CAAChC,SAAL,GAAiB,KAAjB;AACD;AANH,yBADO,EAQJ;AACD6B,8BAAI,EAAE,IADL;AAEDG,iCAAO,EAAE,mBAAM;AACbC,kCAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,2SAA2SC,OAA3S,CAAmT,IAAnT,EAAyT,KAAI,CAACzB,cAA9T,CAAvB;AACA,iCAAI,CAACX,SAAL,GAAiB,KAAjB;AACD;AALA,yBARI;AAHqC,uBAA5B,CAAN;;;AAARqC,2B;;AAqBN,6BAAMA,KAAK,CAACzB,OAAN,GAAgBY,IAAhB,CAAqB,YAAY,CACtC,CAD0B,CACzBF,IADyB,CACpB,IADoB,CAArB,CAAN;;;;;;;;;AAED;AA/FqB;AAAA;AAAA,+CAiGDgB,QAjGC,EAiGiB;AACrC,gBAAMC,MAAM,GAAG,KAAKvB,gBAAL,CAAsBwB,IAAtB,CAA2B,UAAAC,CAAC;AAAA,qBAAIA,CAAC,CAACC,QAAF,KAAeJ,QAAnB;AAAA,aAA5B,CAAf;AACA,iBAAKrC,aAAL,GAAqBsC,MAAM,IAAI,IAA/B;AACA5D,mBAAO,CAACC,GAAR,CAAY,YAAZ,EAA0B2D,MAA1B;AACD;AArGqB;AAAA;AAAA,0CAuGNI,GAvGM,EAuGQ;AAC5B,iBAAKC,aAAL,GAAqBD,GAArB;AACD;AAzGqB;AAAA;AAAA,2CA2GL;AACf,gBAAM7B,IAAI,GAAG;AACXG,wBAAU,EAAE,KAAKA,UADN;AAEX2B,2BAAa,EAAE,KAAKA;AAFT,aAAb,CADe,CAMf;AACD;AAlHqB;;AAAA;AAAA,S;;;;gBAXE;;gBAIjB;;gBAJA;;;;;;gBAYN;;;AADU9C,iBAAW,6DALvB,gEAAU;AACTX,gBAAQ,EAAE,UADD;AAETC,gBAAQ,EAAR;AAAA;AAAA,gGAFS;;;;AAAA,OAAV,CAKuB,GAAXU,WAAW,CAAX","file":"scanner-scanner-module-es5.js","sourcesContent":["export default \"<div *ngIf=\\\"product\\\">\\n  <link rel=\\\"stylesheet\\\" href=\\\"https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css\\\" integrity=\\\"sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2\\\" crossorigin=\\\"anonymous\\\">\\n  <ion-header translucent>\\n    <ion-toolbar>\\n      <ion-title>{{ product.product_name }}</ion-title>\\n      <ion-buttons slot=\\\"end\\\">\\n        <ion-button (click)=\\\"dismissModal()\\\">Schliessen</ion-button>\\n      </ion-buttons>\\n    </ion-toolbar>\\n  </ion-header>\\n  <ion-content fullscreen>\\n    <img [src]=\\\"product.image_url\\\">\\n    <button (click)=\\\"confirmAdding()\\\">Produkt hinzufügen</button>\\n    <table class=\\\"table\\\">\\n      <thead>\\n        <tr>\\n          <th>Menge</th>\\n          <th>Nährwert</th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n        <tr>\\n          <td>Kohlenhydrate</td>\\n          <td>{{ product.nutriments.carbohydrates }}</td>\\n        </tr>\\n        <tr>\\n          <td>davon Zucker</td>\\n          <td>{{ product.nutriments.fat }}</td>\\n        </tr>\\n        <tr>\\n          <td>Energie</td>\\n          <td>{{ product.nutriments.energy }}kJ / {{ product.nutriments['energy-kcal'] }}kJ</td>\\n        </tr>\\n        <tr>\\n          <td>Fett</td>\\n          <td>{{ product.nutriments.fat }}</td>\\n        </tr>\\n      </tbody>\\n    </table>\\n  </ion-content>\\n</div>\";","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>Barcode-Scanner</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content *ngIf=\\\"enabled\\\">\\n  <zxing-scanner [(device)]=\\\"currentDevice\\\" (scanSuccess)=\\\"onCodeResult($event)\\\"\\n  [formats]=\\\"formatsEnabled\\\"  [enable]=\\\"enabled\\\" (permissionResponse)=\\\"onHasPermission($event)\\\"\\n  (camerasFound)=\\\"onCamerasFound($event)\\\"></zxing-scanner>\\n</ion-content>\\n\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2FkZC1wcm9kdWN0L2FkZC1wcm9kdWN0LmNvbXBvbmVudC5zY3NzIn0= */\";","import { Component, Input, OnInit } from '@angular/core';\nimport { AlertController } from '@ionic/angular';\nimport { ModalController } from '@ionic/angular';\nimport { IProduct } from '../iproduct';\nimport { ProductsService } from '../products.service';\n\n@Component({\n  selector: 'app-add-product',\n  templateUrl: './add-product.component.html',\n  styleUrls: ['./add-product.component.scss'],\n})\nexport class AddProductComponent implements OnInit {\n  @Input() code: string;\n  public product: IProduct;\n  constructor(public modalController: ModalController, public productsService: ProductsService) { }\n\n  async ngOnInit() {\n    console.log(this.code);\n    var product = await this.productsService.getProductDetails(this.code);\n    this.product = product;\n    console.log(product);\n  }\n  \n  async confirmAdding() {\n    var status = await this.productsService.addProduct(this.product); \n    this.modalController.dismiss();\n  }\n\n  dismissModal() {\n    if (this.modalController) {\n      this.modalController.dismiss({\n      });\n    }\n  }\n\n}\n","import { NgModule } from \"@angular/core\";\nimport { Routes, RouterModule } from \"@angular/router\";\n\nimport { ScannerPage } from \"./scanner.page\";\n\nconst routes: Routes = [\n  {\n    path: \"\",\n    component: ScannerPage,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ScannerPageRoutingModule {}\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { FormsModule } from \"@angular/forms\";\n\nimport { IonicModule } from \"@ionic/angular\";\n\nimport { ScannerPageRoutingModule } from \"./scanner-routing.module\";\n\nimport { ScannerPage } from \"./scanner.page\";\nimport { ZXingScannerModule } from \"@zxing/ngx-scanner\";\nimport { AddProductComponent } from '../add-product/add-product.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ScannerPageRoutingModule,\n    ZXingScannerModule,\n  ],\n  exports: [\n    ScannerPage,\n    AddProductComponent\n  ],\n  declarations: [ScannerPage, AddProductComponent],\n})\nexport class ScannerPageModule { }\n","export default \"zxing-scanner {\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvc2Nhbm5lci9zY2FubmVyLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFlBQUE7QUFDSiIsImZpbGUiOiJzcmMvYXBwL3NjYW5uZXIvc2Nhbm5lci5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJ6eGluZy1zY2FubmVyIHtcbiAgICBoZWlnaHQ6IDEwMCU7XG59Il19 */\";","import { Component, Input, OnInit } from '@angular/core';\nimport { AlertController, ModalController } from '@ionic/angular';\nimport { BarcodeFormat } from '@zxing/library';\nimport { BehaviorSubject } from 'rxjs';\nimport { AddProductComponent } from '../add-product/add-product.component';\nimport { ProductsService } from '../products.service';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: 'scanner.page.html',\n  styleUrls: ['./scanner.page.scss']\n})\nexport class ScannerPage{\n  @Input() modalOpen = false;\n\n  availableDevices: MediaDeviceInfo[];\n  currentDevice: MediaDeviceInfo = null;\n\n  formatsEnabled: BarcodeFormat[] = [\n    BarcodeFormat.CODE_128,\n    BarcodeFormat.DATA_MATRIX,\n    BarcodeFormat.EAN_13,\n    BarcodeFormat.QR_CODE,\n  ];\n  hasDevices: boolean;\n  hasPermission: boolean;\n\n  qrResultString: string;\n\n  enabled = true;\n\n  modal: HTMLIonModalElement = null;\n\n\n  constructor(\n    public modalController: ModalController,\n    public productsService: ProductsService,\n    public alertController: AlertController) {\n  }\n  ionViewWillEnter() {\n    console.log('enter')\n    this.enabled = true;\n  }\n  ionViewWillLeave() {\n    console.log('leave')\n    this.enabled = false;\n  }\n  async generateModal() {\n    this.modal = await this.modalController.create({\n      component: AddProductComponent,\n      componentProps: {\n        code: this.qrResultString\n      }\n    });\n    await this.modal.present();\n    let { data } = await this.modal.onWillDismiss();\n    this.modalOpen = false;\n  }\n\n  clearResult(): void {\n    this.qrResultString = null;\n  }\n\n  onCamerasFound(devices: MediaDeviceInfo[]): void {\n    this.availableDevices = devices;\n    this.hasDevices = Boolean(devices && devices.length);\n  }\n\n  onCodeResult(resultString: string) {\n    this.qrResultString = resultString;\n    var errorDialog = this.errorDialog.bind(this);\n    var generateModal = this.generateModal.bind(this);\n    if (this.modalOpen === false) {\n      this.modalOpen = true;\n      this.productsService.getProductDetails(resultString).then(function () {\n        generateModal();\n      }).catch(function (error) {\n        console.log(error);\n        errorDialog();\n      })\n    }\n  }\n\n  async errorDialog() {\n    const alert = await this.alertController.create({\n      header: 'Fehler',\n      message: 'Das gescannte Produkt ist nicht in unserer Datenbank erfasst. Möchten Sie dies dem Entwickler melden?',\n      buttons: [\n        {\n          text: 'Nein',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: () => {\n            this.modalOpen = false;\n          }\n        }, {\n          text: 'Ja',\n          handler: () => {\n            window.location.href = \"mailto:nutriinfo.app@gmail.com?subject=Fehlerbericht%20NutriInfo&body=Ein%20Fehler%20mit%20dem%20Barcode%20Scanner%20wurde%20erkannt.%20Der%20Barcode%20\\\"[]\\\"%20konnte%20nicht%20in%20unserer%20Datenbank%20gefunden%20werden.%0D%0ABitte%20geben%20Sie%20manuell%20den%20Namen%20des%20Produktes%20an:\".replace(\"[]\", this.qrResultString);\n            this.modalOpen = false;\n          }\n        }\n      ]\n    });\n\n    await alert.present().then(function () {\n    }.bind(this))\n  }\n\n  onDeviceSelectChange(selected: string) {\n    const device = this.availableDevices.find(x => x.deviceId === selected);\n    this.currentDevice = device || null;\n    console.log(\"new device\", device)\n  }\n\n  onHasPermission(has: boolean) {\n    this.hasPermission = has;\n  }\n\n  openInfoDialog() {\n    const data = {\n      hasDevices: this.hasDevices,\n      hasPermission: this.hasPermission,\n    };\n\n    // this._dialog.open(AppInfoDialogComponent, { data });\n  }\n}\n"]}